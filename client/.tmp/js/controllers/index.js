(function(){angular.module("app").controller("IndexController",["$scope","LoopBackAuth","User",function(n,e,s){var r,i,o,t,c,g;r=this,r.signInUser={},r.signUpUser={},i=function(){var n;if(n=r.currentUser||{},n.id=e.currentUserId,n.accessToken=e.accessTokenId,r.currentUser=n,n.id)return s.getCurrent().$promise["catch"](function(n){e.clearUser(),e.clearStorage(),r.currentUser={}})},i(),o=function(e){r.signInUser={},n.signInForm.$setPristine(),i(),$("#sign-in").modal("hide")},t=function(n){r.signInFailMsg=n.data.error.message},r.signIn=function(){return r.signInFailMsg=null,s.login(r.signInUser).$promise.then(o)["catch"](t)},c=function(e){r.signInUser={},r.signInUser.username=r.signUpUser.username,r.signUpUser={},n.signUpForm.$setPristine(),$("#sign-up").modal("hide"),$("#sign-in").modal("show")},g=function(n){r.signUpFailMsg=n.data.error.message,console.log(r.signUpFailMsg)},r.hideSignUpFailMsg=function(){r.signUpFailMsg=null},r.signUp=function(){var n;return r.hideSignUpFailMsg(),n=_.cloneDeep(r.signUpUser),delete n.rpassword,s.create(n).$promise.then(c)["catch"](g)},r.logout=function(){return s.logout().$promise.then(function(n){return console.log(n)})["catch"](function(n){return console.log(n)})}}])}).call(this);