"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="lbServices"),function(e,t,r){"use strict";function o(e){var t=e.match(/^(?:https?:)?\/\/([^\/]+)/);return t?t[1]:null}var s="/api",n="authorization",u=o(s)||location.host,d=t.module("lbServices",["ngResource"]);d.factory("Todo",["LoopBackResource","LoopBackAuth","$injector",function(e,t,r){var o=e(s+"/todos/:id",{id:"@id"},{prototype$__get__owner:{url:s+"/todos/:id/owner",method:"GET"},create:{url:s+"/todos",method:"POST"},createMany:{isArray:!0,url:s+"/todos",method:"POST"},upsert:{url:s+"/todos",method:"PUT"},exists:{url:s+"/todos/:id/exists",method:"GET"},findById:{url:s+"/todos/:id",method:"GET"},find:{isArray:!0,url:s+"/todos",method:"GET"},findOne:{url:s+"/todos/findOne",method:"GET"},updateAll:{url:s+"/todos/update",method:"POST"},deleteById:{url:s+"/todos/:id",method:"DELETE"},count:{url:s+"/todos/count",method:"GET"},prototype$updateAttributes:{url:s+"/todos/:id",method:"PUT"}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.modelName="Todo",o.owner=function(){var e=r.get("User"),t=e["::get::Todo::owner"];return t.apply(o,arguments)},o}]),d.factory("User",["LoopBackResource","LoopBackAuth","$injector",function(e,t,r){var o=e(s+"/users/:id",{id:"@id"},{prototype$__findById__accessTokens:{params:{fk:"@fk"},url:s+"/users/:id/accessTokens/:fk",method:"GET"},prototype$__destroyById__accessTokens:{params:{fk:"@fk"},url:s+"/users/:id/accessTokens/:fk",method:"DELETE"},prototype$__updateById__accessTokens:{params:{fk:"@fk"},url:s+"/users/:id/accessTokens/:fk",method:"PUT"},prototype$__get__accessTokens:{isArray:!0,url:s+"/users/:id/accessTokens",method:"GET"},prototype$__create__accessTokens:{url:s+"/users/:id/accessTokens",method:"POST"},prototype$__delete__accessTokens:{url:s+"/users/:id/accessTokens",method:"DELETE"},prototype$__count__accessTokens:{url:s+"/users/:id/accessTokens/count",method:"GET"},create:{url:s+"/users",method:"POST"},createMany:{isArray:!0,url:s+"/users",method:"POST"},upsert:{url:s+"/users",method:"PUT"},exists:{url:s+"/users/:id/exists",method:"GET"},findById:{url:s+"/users/:id",method:"GET"},find:{isArray:!0,url:s+"/users",method:"GET"},findOne:{url:s+"/users/findOne",method:"GET"},updateAll:{url:s+"/users/update",method:"POST"},deleteById:{url:s+"/users/:id",method:"DELETE"},count:{url:s+"/users/count",method:"GET"},prototype$updateAttributes:{url:s+"/users/:id",method:"PUT"},createChangeStream:{url:s+"/users/change-stream",method:"POST"},login:{params:{include:"user"},interceptor:{response:function(e){var r=e.data;return t.setUser(r.id,r.userId,r.user),t.rememberMe=e.config.params.rememberMe!==!1,t.save(),e.resource}},url:s+"/users/login",method:"POST"},logout:{interceptor:{response:function(e){return t.clearUser(),t.clearStorage(),e.resource},responseError:function(e){return t.clearUser(),t.clearStorage(),e.resource}},url:s+"/users/logout",method:"POST"},confirm:{url:s+"/users/confirm",method:"GET"},resetPassword:{url:s+"/users/reset",method:"POST"},"::get::Todo::owner":{url:s+"/todos/:id/owner",method:"GET"},getCurrent:{url:s+"/users/:id",method:"GET",params:{id:function(){var e=t.currentUserId;return null==e&&(e="__anonymous__"),e}},interceptor:{response:function(e){return t.currentUserData=e.data,e.resource}},__isGetCurrentUser__:!0}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.getCachedCurrent=function(){var e=t.currentUserData;return e?new o(e):null},o.isAuthenticated=function(){return null!=this.getCurrentId()},o.getCurrentId=function(){return t.currentUserId},o.modelName="User",o}]),d.factory("Setting",["LoopBackResource","LoopBackAuth","$injector",function(e,t,r){var o=e(s+"/settings/:id",{id:"@id"},{create:{url:s+"/settings",method:"POST"},createMany:{isArray:!0,url:s+"/settings",method:"POST"},upsert:{url:s+"/settings",method:"PUT"},exists:{url:s+"/settings/:id/exists",method:"GET"},findById:{url:s+"/settings/:id",method:"GET"},find:{isArray:!0,url:s+"/settings",method:"GET"},findOne:{url:s+"/settings/findOne",method:"GET"},updateAll:{url:s+"/settings/update",method:"POST"},deleteById:{url:s+"/settings/:id",method:"DELETE"},count:{url:s+"/settings/count",method:"GET"},prototype$updateAttributes:{url:s+"/settings/:id",method:"PUT"},createChangeStream:{url:s+"/settings/change-stream",method:"POST"},findByKey:{url:s+"/settings/:key",method:"GET"},updateByKey:{url:s+"/settings/:key",method:"PUT"}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.modelName="Setting",o}]),d.factory("LoopBackAuth",function(){function e(){var e=this;o.forEach(function(t){e[t]=r(t)}),this.currentUserData=null}function t(e,t,r){try{var o=s+t;null==r&&(r=""),e[o]=r}catch(n){console.log("Cannot access local/session storage:",n)}}function r(e){var t=s+e;return localStorage[t]||sessionStorage[t]||null}var o=["accessTokenId","currentUserId","rememberMe"],s="$LoopBack$";return e.prototype.save=function(){var e=this,r=this.rememberMe?localStorage:sessionStorage;o.forEach(function(o){t(r,o,e[o])})},e.prototype.setUser=function(e,t,r){this.accessTokenId=e,this.currentUserId=t,this.currentUserData=r},e.prototype.clearUser=function(){this.accessTokenId=null,this.currentUserId=null,this.currentUserData=null},e.prototype.clearStorage=function(){o.forEach(function(e){t(sessionStorage,e,null),t(localStorage,e,null)})},new e}).config(["$httpProvider",function(e){e.interceptors.push("LoopBackAuthRequestInterceptor")}]).factory("LoopBackAuthRequestInterceptor",["$q","LoopBackAuth",function(e,t){return{request:function(s){var d=o(s.url);if(d&&d!==u)return s;if(t.accessTokenId)s.headers[n]=t.accessTokenId;else if(s.__isGetCurrentUser__){var a={body:{error:{status:401}},status:401,config:s,headers:function(){return r}};return e.reject(a)}return s||e.when(s)}}}]).provider("LoopBackResource",function(){this.setAuthHeader=function(e){n=e},this.getAuthHeader=function(){return n},this.setUrlBase=function(e){s=e,u=o(s)||location.host},this.getUrlBase=function(){return s},this.$get=["$resource",function(e){var t=function(t,r,o){var s=e(t,r,o);return s.prototype.$save=function(e,t){var r=s.upsert.call(this,{},this,e,t);return r.$promise||r},s};return t.getUrlBase=function(){return s},t.getAuthHeader=function(){return n},t}]})}(window,window.angular);